<p>The following code will query some data from the Oracle Database and will export them on a CSV file.<br />
The webserver where this script is executed should have the OCI8 library installed.<br />
The execution of this script can be also scheduled to have a periodic backup of a certain table.</p>
<p><img src="https://i0.wp.com/www.danilovizzarro.it/wp-content/uploads/2009/12/123778689728930718_HEbUuRcS_f-e1345994962142.jpg?resize=600%2C436" alt="" title="Backup Oracle Table" class="aligncenter size-full wp-image-593" data-recalc-dims="1" /></p>
<p>The script below will extract from the system the forms used by each Oracle EBS user.</p>
<p><code><br />
$ORACLE_USERNAME = 'RAC_ACCNT';<br />
$ORACLE_PASSWORD = 'PASSWORD';<br />
$ORACLE_SID = 'SID';</p>
<p>$ORACLE_CONNECT = OCILogon($ORACLE_USERNAME, $ORACLE_PASSWORD, $ORACLE_SID);</p>
<p>$time = date("H_i");<br />
$day = date("d");<br />
$month = strtoupper(date("m"));<br />
$year = date("Y");<br />
$today = $year . "-" . $month . "-" . $day;</p>
<p>// FND_LOGINS<br />
$query_table_to_backup = "<br />
SELECT DISTINCT<br />
D.USER_NAME,<br />
E.RESPONSIBILITY_NAME,<br />
TO_CHAR(A.START_TIME,'DD-MON-YYYY HH24:MI:SS'),<br />
TO_CHAR(A.END_TIME,'DD-MON-YYYY HH24:MI:SS'),<br />
G.USER_FORM_NAME,<br />
TO_CHAR(F.START_TIME,'DD-MON-YYYY HH24:MI:SS') FORM_START_TIME,<br />
TO_CHAR(F.END_TIME,'DD-MON-YYYY HH24:MI:SS') FORM_END_TIME,<br />
F.START_TIME FORM_START_TIME_ORDER<br />
FROM<br />
FND_LOGIN_RESPONSIBILITIES A,<br />
FND_RESPONSIBILITY B,<br />
FND_LOGINS C,<br />
FND_USER D,<br />
FND_RESPONSIBILITY_TL E,<br />
FND_LOGIN_RESP_FORMS F,<br />
FND_FORM_TL G<br />
WHERE<br />
A.RESPONSIBILITY_ID = B.RESPONSIBILITY_ID<br />
AND A.RESPONSIBILITY_ID = E.RESPONSIBILITY_ID<br />
AND B.RESPONSIBILITY_ID = E.RESPONSIBILITY_ID<br />
AND A.LOGIN_RESP_ID = F.LOGIN_RESP_ID<br />
AND C.LOGIN_ID = A.LOGIN_ID<br />
AND A.LOGIN_ID = F.LOGIN_ID<br />
AND C.LOGIN_ID = F.LOGIN_ID<br />
AND C.USER_ID = D.USER_ID<br />
AND G.FORM_ID = F.FORM_ID<br />
AND E.LANGUAGE = 'US'<br />
AND G.LANGUAGE = 'US'<br />
AND B.APPLICATION_ID = G.APPLICATION_ID<br />
AND A.START_TIME > SYSDATE - 30<br />
ORDER BY FORM_START_TIME_ORDER DESC<br />
";</p>
<p>$output_file = "output/" . $ORACLE_SID . "_FND_LOGINS_BACKUP_" . $today . "_" . $time . ".csv";<br />
$output_name = $ORACLE_SID . "_FND_LOGINS_BACKUP_" . $today . "_" . $time . ".csv";<br />
$fh = fopen($output_file, 'w') or die("can't open file");</p>
<p>$ORACLE_STATIC = OCIParse($ORACLE_CONNECT, $query_table_to_backup);<br />
OCIExecute($ORACLE_STATIC, OCI_DEFAULT);</p>
<p>while ($PRINT_RECORD = oci_fetch_array ($ORACLE_STATIC, OCI_BOTH))<br />
{<br />
	$stringData = $PRINT_RECORD[0] . ";" . $PRINT_RECORD[1] . ";" . $PRINT_RECORD[2] . ";" . $PRINT_RECORD[3] . ";" . $PRINT_RECORD[4] . ";" . $PRINT_RECORD[5] . ";" . $PRINT_RECORD[6] . ";" . $PRINT_RECORD[7] . ";" . $PRINT_RECORD[8] . ";" . $PRINT_RECORD[9] . ";" . $PRINT_RECORD[10] . ";" . $PRINT_RECORD[11] . ";" . $PRINT_RECORD[12] . ";" . $PRINT_RECORD[13] . ";" . $PRINT_RECORD[14] . ";" . $PRINT_RECORD[15] . ";" . $PRINT_RECORD[16] . ";" . $PRINT_RECORD[17] . ";" . $PRINT_RECORD[18] . ";" . $PRINT_RECORD[19] . "n";<br />
fwrite($fh, $stringData);<br />
}</p>
<p>fclose($fh);<br />
</code></p>
