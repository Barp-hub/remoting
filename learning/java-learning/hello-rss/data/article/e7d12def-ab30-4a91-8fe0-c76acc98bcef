In this post, I'll show how to execute a VO(or it's view criteria) added as a view accessor in another VO. <br /><br /><b>Sample Use case:</b><br />For example we have two VOs DeptVO(based on only DeptEO) and EmpDeptVO(based on empEO and DeptEO) and the DeptVO is added a view accessor in EmpDeptVO and we need to programmatically execute this view accessor to get the Deptno for the passed Dname (assuming it DeptVO has a view criteria that takes Dname as a parameter or bind variable) and set the DetpNo for the newly created row in EmpDeptVO. You can download the sample application from <a href="http://adftips.googlecode.com/files/ExecutingViewAccessor.zip">here</a>.<br /><br /><b>Implementation Steps:</b><br />1. Create DeptVO based on DeptEO and create a view criteria "findByDeptName" that queries based on the bind variable 'Bind_Dname'.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_ex9GjJ9fvbk/TO5zfIraL2I/AAAAAAAAAR4/DSbTSOI64Cc/s1600/1.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="247" src="http://1.bp.blogspot.com/_ex9GjJ9fvbk/TO5zfIraL2I/AAAAAAAAAR4/DSbTSOI64Cc/s320/1.JPG" width="320" /></a></div><br />2. Create EmpDeptVO and add the DeptVO as view accessor (DeptVA) and select the view criteria "findByDeptName" in the VA definition.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_ex9GjJ9fvbk/TO5zgTIsD3I/AAAAAAAAAR8/qi9F5Dmu1K8/s1600/2.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="277" src="http://1.bp.blogspot.com/_ex9GjJ9fvbk/TO5zgTIsD3I/AAAAAAAAAR8/qi9F5Dmu1K8/s320/2.JPG" width="320" /></a></div><br />3. Generate RowImpl class for EmpDeptVO. The generated class name will be EmpDeptVORowImpl.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_ex9GjJ9fvbk/TO5zgw75szI/AAAAAAAAASA/MwvVFU7Rl60/s1600/3.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/_ex9GjJ9fvbk/TO5zgw75szI/AAAAAAAAASA/MwvVFU7Rl60/s1600/3.JPG" /></a></div><br />4. Now, write a method say "getDeptIdFromViewAccessor" in EmpDeptVORowImpl that takes 'Dname' as parameter that executes the view accessor DeptVA and returns the DeptId for the passed 'Dname'. Code below:<br /><div id="iframeDiv58984e33-c3cc-4189-87f3-b069009d6c53" style="display: none; margin: 0px;"><iframe frameborder="0" id="iframe58984e33-c3cc-4189-87f3-b069009d6c53" src="http://www.blogtrog.com/code.aspx?id=58984e33-c3cc-4189-87f3-b069009d6c53" style="border: 1px solid rgb(224, 224, 224); height: 270px; margin: 0px; width: 400px;"></iframe></div><div id="noIframeDiv58984e33-c3cc-4189-87f3-b069009d6c53" style="display: block; margin: 0px;"><pre><div><span style="color: black;">    </span><span style="color: blue;">public</span><span style="color: black;"> Object getDeptIdFromViewAccessor(String deptName) {<br />        </span><span style="color: green;">//</span><span style="color: green;">here getDeptVA is the getter for the view accessor 'DeptVA' in EmpDeptVO</span><span style="color: green;"><br /></span><span style="color: black;">        RowSet rowSet </span><span style="color: black;">=</span><span style="color: black;"> </span><span style="color: blue;">this</span><span style="color: black;">.getDeptVA();<br />        </span><span style="color: green;">//</span><span style="color: green;">setting the range size to -1 to get all the rows</span><span style="color: green;"><br /></span><span style="color: black;">        rowSet.setRangeSize(</span><span style="color: black;">-</span><span style="color: black;">1</span><span style="color: black;">);<br />        </span><span style="color: green;">//</span><span style="color: green;">passing the value for bind parameter for the view accessor</span><span style="color: green;"><br /></span><span style="color: black;">        rowSet.setNamedWhereClauseParam(</span><span style="color: black;">"</span><span style="color: black;">Bind_Dname</span><span style="color: black;">"</span><span style="color: black;">, deptName);<br />        </span><span style="color: green;">//</span><span style="color: green;">executing the view accessor</span><span style="color: green;"><br /></span><span style="color: black;">        rowSet.executeQuery();<br />        </span><span style="color: green;">//</span><span style="color: green;">storing the first row in the row set in deptRow (there can be multiple rows in the row set based on the criteria)</span><span style="color: green;"><br /></span><span style="color: black;">        Row deptRow </span><span style="color: black;">=</span><span style="color: black;"> rowSet.first();<br />        </span><span style="color: green;">//</span><span style="color: green;">if the dpetRow is not null, returning the Deptno</span><span style="color: green;"><br /></span><span style="color: black;">        </span><span style="color: blue;">return</span><span style="color: black;"> (deptRow </span><span style="color: black;">!=</span><span style="color: black;"> </span><span style="color: blue;">null</span><span style="color: black;">) </span><span style="color: black;">?</span><span style="color: black;"> deptRow.getAttribute(</span><span style="color: black;">"</span><span style="color: black;">Deptno</span><span style="color: black;">"</span><span style="color: black;">) : </span><span style="color: blue;">null</span><span style="color: black;">;<br />    }</span></div></pre></div><script language="javascript" src="http://www.blogtrog.com/scripts/bt_code.js" type="text/javascript"></script><script language="javascript" type="text/javascript">bt_code_init('58984e33-c3cc-4189-87f3-b069009d6c53'); </script><br /><br />5. Call the above EmpDeptVORowImpl method in AmImpl's method say "testExecuteViewAccessor" passing the Dname for which the DeptId is required. Now, set this deptId to the newly created EmpDeptVO row in AMImpl method. Code below:<br /><div id="iframeDiv17bfd20b-a986-4911-adf0-f282427d1260" style="display: none; margin: 0px;"><iframe frameborder="0" id="iframe17bfd20b-a986-4911-adf0-f282427d1260" src="http://www.blogtrog.com/code.aspx?id=17bfd20b-a986-4911-adf0-f282427d1260" style="border: 1px solid rgb(224, 224, 224); height: 220px; margin: 0px; width: 400px;"></iframe></div><div id="noIframeDiv17bfd20b-a986-4911-adf0-f282427d1260" style="display: block; margin: 0px;"><pre><div><span style="color: black;">    </span><span style="color: blue;">public</span><span style="color: black;"> </span><span style="color: blue;">void</span><span style="color: black;"> testExecuteViewAccessor(){<br />      ViewObjectImpl empDeptVO </span><span style="color: black;">=</span><span style="color: black;"> </span><span style="color: blue;">this</span><span style="color: black;">.getEmpDeptVO();<br />      Row row </span><span style="color: black;">=</span><span style="color: black;"> empDeptVO.createRow();<br />      empDeptVO.insertRow(row);<br />      EmpDeptVORowImpl empDeptRow </span><span style="color: black;">=</span><span style="color: black;"> (EmpDeptVORowImpl)empDeptVO.getCurrentRow(); <br />      </span><span style="color: green;">//</span><span style="color: green;">calling the EmpDeptVORowImpl method to get the deptId for the deptName 'accounting'</span><span style="color: green;"><br /></span><span style="color: black;">      Object deptId </span><span style="color: black;">=</span><span style="color: black;"> empDeptRow.getDeptIdFromViewAccessor(</span><span style="color: black;">"</span><span style="color: black;">accounting</span><span style="color: black;">"</span><span style="color: black;">);<br />      System.out.println(</span><span style="color: black;">"</span><span style="color: black;">DeptId from view accessor: </span><span style="color: black;">"</span><span style="color: black;">+</span><span style="color: black;">deptId);<br />      </span><span style="color: green;">//</span><span style="color: green;">setting the deptId to the current row's 'Deptno' attribute.</span><span style="color: green;"><br /></span><span style="color: black;">      empDeptRow.setDeptno((Number)deptId);<br />    }</span></div></pre></div><script language="javascript" src="http://www.blogtrog.com/scripts/bt_code.js" type="text/javascript"></script><script language="javascript" type="text/javascript">bt_code_init('17bfd20b-a986-4911-adf0-f282427d1260'); </script><br /><br />Here is the sample output on running this method using AM tester.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_ex9GjJ9fvbk/TO51_BeWavI/AAAAAAAAASE/vv6_9-wPHG8/s1600/4.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="82" src="http://4.bp.blogspot.com/_ex9GjJ9fvbk/TO51_BeWavI/AAAAAAAAASE/vv6_9-wPHG8/s320/4.JPG" width="320" /></a></div><br />That's it. Now you know how to execute the view accessor(VA) programatically, how to pass the parameters for the view criteria selected in VA definition, how to get and use the results in AMImpl methods.<br /><br />PS: DeptId and Deptno are used interchangeably in this post.