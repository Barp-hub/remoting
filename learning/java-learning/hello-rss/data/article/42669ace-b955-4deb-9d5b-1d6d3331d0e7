Generally, if we want to refresh a field or part of the page, we use ppr (partial page rendering) in ADF. We just specify the id of the component (<b>whose state change should trigger refresh</b>) for the partialTriggers property of the <b>required component to be refreshed</b>. It's that simple. But, when we use task flows as regions in our pages, many times we need to establish communication between the parent page containing the region and the region itself. Similarly if there are two regions in the same jsff and some times we need to refresh one region based on some actin done on another region. Here, in this post I'm going to explain this case.<br /><br /><b>Sample UseCase:</b><br />For example, we have two task flows- one task flow displays the departments in a table and the second task flow shows the employees present in department for which the Deptno is passed as a task flow parameter. Now, the requirement is that based on the department selected in the first region, the second region needs to be refreshed with the employees in that particular selected department provided these two regions are dropped in a single jsf page. Sample example application can be downloaded from <a href="http://adftips.googlecode.com/files/RegionInteraction_peers.zip">here</a>. Here, actually we're establishing a communication between the two regions present in the same jsf page.<br /><br /><b>Implementation Details:</b><br />Before going through the implmentation steps, lets have a quick review of task flow basics.<br /><br /><i>If you drop a task flow that takes some parameters as a region in a jsff page, the task flow binding will be added in the pagedef file. If you set refresh='ifNeeded' for the task flow binding, the task flow will be re-executed each time when the value for one of the passed parameters got changed. To be clear, here re-execution means the task-flow will re-execute from it's default activity in the task flow diagram.</i><br /><br />In other words, if you drop task flow TF that takes parameters param1,param2 in a jsf page abc.jsff, and if you specify refresh='ifNeeded' for the task flow binding in pagdef, and if you give the values for param1 and param2 as #{pageFlowScope.param1} and #{pageFlowScope.param2}, the task flow will be re-executed if any of the pageflowScope param values changed to a different value. <br /><br />Knowing the above point is very important to implement interaction between two regions. <br /><br /><b>Implementation Steps:</b><br />1. Make two task flows ready - <br />i. TaskFlow1 - This task flow displays departments table with a button 'Show Employees'. <br />ii. TaskFlow2 - This task flow takes a parameter deptId and based on the passed deptId, it'll query the employees in the dept and displays them in a table.<br /><br />TaskFlow2 Diagram:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_ex9GjJ9fvbk/TNRQBxWgNvI/AAAAAAAAAO0/5pQZL5bWwgA/s1600/1.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="227" src="http://3.bp.blogspot.com/_ex9GjJ9fvbk/TNRQBxWgNvI/AAAAAAAAAO0/5pQZL5bWwgA/s320/1.JPG" width="320" /></a></div><br />2. Create a java bean with the property deptId and generate accessors for it. Now, <a href="http://www.adftips.com/2010/11/adf-ui-beginner-creating-data-control.html">create data control for the bean</a>. <br /><br />Java bean containing the property 'deptId':<br /><div id="iframeDiva54671ca-8202-4f5e-b6e3-b34dc8586501" style="display: none; margin: 0px;"><iframe frameborder="0" id="iframea54671ca-8202-4f5e-b6e3-b34dc8586501" src="http://www.blogtrog.com/code.aspx?id=a54671ca-8202-4f5e-b6e3-b34dc8586501" style="border: 1px solid #e0e0e0; height: 190px; margin: 0px; width: 400px;"></iframe></div><div id="noIframeDiva54671ca-8202-4f5e-b6e3-b34dc8586501" style="display: block; margin: 0px;"><pre><div><span style="color: blue;">package</span><span style="color: black;"> com.demo.beans;
<br /></span><span style="color: blue;">public</span><span style="color: black;"> </span><span style="color: blue;">class</span><span style="color: black;"> SharedBean {
<br />    </span><span style="color: blue;">private</span><span style="color: black;"> Integer deptId;
<br />    </span><span style="color: blue;">public</span><span style="color: black;"> </span><span style="color: blue;">void</span><span style="color: black;"> setDeptId(Integer deptId) {
<br />        </span><span style="color: blue;">this</span><span style="color: black;">.deptId </span><span style="color: black;">=</span><span style="color: black;"> deptId;
<br />    }
<br />    </span><span style="color: blue;">public</span><span style="color: black;"> Integer getDeptId() {
<br />        </span><span style="color: blue;">return</span><span style="color: black;"> deptId;
<br />    }
<br />}
<br /></span></div></pre></div><script language="javascript" src="http://www.blogtrog.com/scripts/bt_code.js" type="text/javascript">
 </script><script language="javascript" type="text/javascript">
 bt_code_init('a54671ca-8202-4f5e-b6e3-b34dc8586501');
 </script><br />3. Now, in the actionListener method for 'Show Employees' button in task flow1, just get the selected deptId and set to the shared bean data control property.<br /><br />ActionListener method code:<br /><div id="iframeDiv9f6c3a23-9755-4111-9a15-3c58ab3a3805" style="display: none; margin: 0px;"><iframe frameborder="0" id="iframe9f6c3a23-9755-4111-9a15-3c58ab3a3805" src="http://www.blogtrog.com/code.aspx?id=9f6c3a23-9755-4111-9a15-3c58ab3a3805" style="border: 1px solid #e0e0e0; height: 150px; margin: 0px; width: 400px;"></iframe></div><div id="noIframeDiv9f6c3a23-9755-4111-9a15-3c58ab3a3805" style="display: block; margin: 0px;"><pre><div><span style="color: black;">    </span><span style="color: blue;">public</span><span style="color: black;"> </span><span style="color: blue;">void</span><span style="color: black;"> buttonClicked(ActionEvent ae) {
<br />        Row currentDeptRow </span><span style="color: black;">=</span><span style="color: black;">
<br />            (Row)ADFUtil.evaluateEL(</span><span style="color: black;">"</span><span style="color: black;">#{bindings.DeptVO.currentRow}</span><span style="color: black;">"</span><span style="color: black;">);
<br />        ADFUtil.setEL(</span><span style="color: black;">"</span><span style="color: black;">#{bindings.deptId.attributeValue}</span><span style="color: black;">"</span><span style="color: black;">,
<br />                      currentDeptRow.getAttribute(</span><span style="color: black;">"</span><span style="color: black;">Deptno</span><span style="color: black;">"</span><span style="color: black;">));
<br />    }</span></div></pre></div><script language="javascript" src="http://www.blogtrog.com/scripts/bt_code.js" type="text/javascript">
 </script><script language="javascript" type="text/javascript">
 bt_code_init('9f6c3a23-9755-4111-9a15-3c58ab3a3805');
 </script><br />4. Drop the two task flows in a single jsff page. It'll ask for the parameter for the TaskFlow2, give the same shared bean data control property 'deptId' as the parameter. Don't forget to set the 'refresh' property for the TaskFlow2 task flow binding to 'ifNeeded'.<br /><br />Parent jsff page code containing these two regions:<br /><div id="iframeDiv3f89e6c4-2a70-4d3f-a488-181aa6e00ae5" style="display: none; margin: 0px;"><iframe frameborder="0" id="iframe3f89e6c4-2a70-4d3f-a488-181aa6e00ae5" src="http://www.blogtrog.com/code.aspx?id=3f89e6c4-2a70-4d3f-a488-181aa6e00ae5" style="border: 1px solid #e0e0e0; height: 320px; margin: 0px; width: 400px;"></iframe></div><div id="noIframeDiv3f89e6c4-2a70-4d3f-a488-181aa6e00ae5" style="display: block; margin: 0px;"><pre><div><span style="color: blue;">&lt;?</span><span style="color: magenta;">xml version='1.0' encoding='windows-1252'</span><span style="color: blue;">?&gt;</span><span style="color: black;">
<br /></span><span style="color: blue;">&lt;</span><span style="color: maroon;">jsp:root </span><span style="color: red;">xmlns:jsp</span><span style="color: blue;">="http://java.sun.com/JSP/Page"</span><span style="color: red;"> version</span><span style="color: blue;">="2.1"</span><span style="color: red;">
<br />          xmlns:af</span><span style="color: blue;">="http://xmlns.oracle.com/adf/faces/rich"</span><span style="color: red;">
<br />          xmlns:f</span><span style="color: blue;">="http://java.sun.com/jsf/core"</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />  </span><span style="color: blue;">&lt;</span><span style="color: maroon;">af:panelGroupLayout </span><span style="color: red;">id</span><span style="color: blue;">="pgl1"</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />    </span><span style="color: blue;">&lt;</span><span style="color: maroon;">af:showDetailHeader </span><span style="color: red;">text</span><span style="color: blue;">="Interaction between two peer regions"</span><span style="color: red;">
<br />                         disclosed</span><span style="color: blue;">="true"</span><span style="color: red;"> id</span><span style="color: blue;">="sdh1"</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />      </span><span style="color: blue;">&lt;</span><span style="color: maroon;">af:panelGroupLayout </span><span style="color: red;">id</span><span style="color: blue;">="pgl3"</span><span style="color: red;"> layout</span><span style="color: blue;">="scroll"</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />        </span><span style="color: blue;">&lt;</span><span style="color: maroon;">af:region </span><span style="color: red;">value</span><span style="color: blue;">="#{bindings.TaskFlow11.regionModel}"</span><span style="color: red;"> id</span><span style="color: blue;">="r1"</span><span style="color: blue;">/&gt;</span><span style="color: black;">
<br />      </span><span style="color: blue;">&lt;/</span><span style="color: maroon;">af:panelGroupLayout</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />      </span><span style="color: blue;">&lt;</span><span style="color: maroon;">af:spacer </span><span style="color: red;">width</span><span style="color: blue;">="10"</span><span style="color: red;"> height</span><span style="color: blue;">="10"</span><span style="color: red;"> id</span><span style="color: blue;">="s1"</span><span style="color: blue;">/&gt;</span><span style="color: black;">
<br />      </span><span style="color: blue;">&lt;</span><span style="color: maroon;">af:panelGroupLayout </span><span style="color: red;">id</span><span style="color: blue;">="pgl4"</span><span style="color: red;"> layout</span><span style="color: blue;">="scroll"</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />        </span><span style="color: blue;">&lt;</span><span style="color: maroon;">af:region </span><span style="color: red;">value</span><span style="color: blue;">="#{bindings.TaskFlow21.regionModel}"</span><span style="color: red;"> id</span><span style="color: blue;">="r2"</span><span style="color: blue;">/&gt;</span><span style="color: black;">
<br />      </span><span style="color: blue;">&lt;/</span><span style="color: maroon;">af:panelGroupLayout</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />    </span><span style="color: blue;">&lt;/</span><span style="color: maroon;">af:showDetailHeader</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />  </span><span style="color: blue;">&lt;/</span><span style="color: maroon;">af:panelGroupLayout</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br /></span><span style="color: blue;">&lt;/</span><span style="color: maroon;">jsp:root</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br /></span></div></pre></div><script language="javascript" src="http://www.blogtrog.com/scripts/bt_code.js" type="text/javascript">
 </script><script language="javascript" type="text/javascript">
 bt_code_init('3f89e6c4-2a70-4d3f-a488-181aa6e00ae5');
 </script><br />Parent Jsff pagedef file:<br /><div id="iframeDiv0b4c5a04-8593-4055-8c59-b783fcb62816" style="display: none; margin: 0px;"><iframe frameborder="0" id="iframe0b4c5a04-8593-4055-8c59-b783fcb62816" src="http://www.blogtrog.com/code.aspx?id=0b4c5a04-8593-4055-8c59-b783fcb62816" style="border: 1px solid #e0e0e0; height: 560px; margin: 0px; width: 400px;"></iframe></div><div id="noIframeDiv0b4c5a04-8593-4055-8c59-b783fcb62816" style="display: block; margin: 0px;"><pre><div><span style="color: blue;">&lt;?</span><span style="color: magenta;">xml version="1.0" encoding="UTF-8" </span><span style="color: blue;">?&gt;</span><span style="color: black;">
<br /></span><span style="color: blue;">&lt;</span><span style="color: maroon;">pageDefinition </span><span style="color: red;">xmlns</span><span style="color: blue;">="http://xmlns.oracle.com/adfm/uimodel"</span><span style="color: red;">
<br />                version</span><span style="color: blue;">="11.1.1.56.60"</span><span style="color: red;"> id</span><span style="color: blue;">="ParentPagePageDef"</span><span style="color: red;">
<br />                Package</span><span style="color: blue;">="com.demo.fragments"</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />  </span><span style="color: blue;">&lt;</span><span style="color: maroon;">parameters</span><span style="color: blue;">/&gt;</span><span style="color: black;">
<br />  </span><span style="color: blue;">&lt;</span><span style="color: maroon;">executables</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />    </span><span style="color: blue;">&lt;</span><span style="color: maroon;">variableIterator </span><span style="color: red;">id</span><span style="color: blue;">="variables"</span><span style="color: blue;">/&gt;</span><span style="color: black;">
<br />    </span><span style="color: blue;">&lt;</span><span style="color: maroon;">taskFlow </span><span style="color: red;">id</span><span style="color: blue;">="TaskFlow11"</span><span style="color: red;">
<br />              taskFlowId</span><span style="color: blue;">="/com/demo/taskflows/TaskFlow1.xml#TaskFlow1"</span><span style="color: red;">
<br />              activation</span><span style="color: blue;">="deferred"</span><span style="color: red;">
<br />              xmlns</span><span style="color: blue;">="http://xmlns.oracle.com/adf/controller/binding"</span><span style="color: red;">
<br />              Refresh</span><span style="color: blue;">="ifNeeded"</span><span style="color: blue;">/&gt;</span><span style="color: black;">
<br />    </span><span style="color: blue;">&lt;</span><span style="color: maroon;">taskFlow </span><span style="color: red;">id</span><span style="color: blue;">="TaskFlow21"</span><span style="color: red;">
<br />              taskFlowId</span><span style="color: blue;">="/com/demo/taskflows/TaskFlow2.xml#TaskFlow2"</span><span style="color: red;">
<br />              activation</span><span style="color: blue;">="deferred"</span><span style="color: red;">
<br />              xmlns</span><span style="color: blue;">="http://xmlns.oracle.com/adf/controller/binding"</span><span style="color: red;">
<br />              Refresh</span><span style="color: blue;">="ifNeeded"</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />      </span><span style="color: blue;">&lt;</span><span style="color: maroon;">parameters</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />        </span><span style="color: blue;">&lt;</span><span style="color: maroon;">parameter </span><span style="color: red;">id</span><span style="color: blue;">="deptId"</span><span style="color: red;"> value</span><span style="color: blue;">="#{bindings.deptId.attributeValue}"</span><span style="color: blue;">/&gt;</span><span style="color: black;">
<br />      </span><span style="color: blue;">&lt;/</span><span style="color: maroon;">parameters</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />    </span><span style="color: blue;">&lt;/</span><span style="color: maroon;">taskFlow</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />    </span><span style="color: blue;">&lt;</span><span style="color: maroon;">iterator </span><span style="color: red;">Binds</span><span style="color: blue;">="root"</span><span style="color: red;"> RangeSize</span><span style="color: blue;">="25"</span><span style="color: red;"> DataControl</span><span style="color: blue;">="SharedBean"</span><span style="color: red;">
<br />              id</span><span style="color: blue;">="SharedBeanIterator"</span><span style="color: blue;">/&gt;</span><span style="color: black;">
<br />  </span><span style="color: blue;">&lt;/</span><span style="color: maroon;">executables</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />  </span><span style="color: blue;">&lt;</span><span style="color: maroon;">bindings</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />    </span><span style="color: blue;">&lt;</span><span style="color: maroon;">attributeValues </span><span style="color: red;">IterBinding</span><span style="color: blue;">="SharedBeanIterator"</span><span style="color: red;"> id</span><span style="color: blue;">="deptId"</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />      </span><span style="color: blue;">&lt;</span><span style="color: maroon;">AttrNames</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />        </span><span style="color: blue;">&lt;</span><span style="color: maroon;">Item </span><span style="color: red;">Value</span><span style="color: blue;">="deptId"</span><span style="color: blue;">/&gt;</span><span style="color: black;">
<br />      </span><span style="color: blue;">&lt;/</span><span style="color: maroon;">AttrNames</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />    </span><span style="color: blue;">&lt;/</span><span style="color: maroon;">attributeValues</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br />  </span><span style="color: blue;">&lt;/</span><span style="color: maroon;">bindings</span><span style="color: blue;">&gt;</span><span style="color: black;">
<br /></span><span style="color: blue;">&lt;/</span><span style="color: maroon;">pageDefinition</span><span style="color: blue;">&gt;</span></div></pre></div><script language="javascript" src="http://www.blogtrog.com/scripts/bt_code.js" type="text/javascript">
 </script><script language="javascript" type="text/javascript">
 bt_code_init('0b4c5a04-8593-4055-8c59-b783fcb62816');
 </script><br />That's it. Now, when the user selects a dept in TaskFlow1 region and clicks on 'Show Employees', the second task flow will be re-executed as the actionListener method changes value of the input parameter of the TaskFlow2. This triggers re-execution of TaskFlow2 and corresponding employees in selected dept in TaskFlow1 will be displayed in TaskFlow2.<br /><br />So, here we're establishing communication by using shared bean data control property. Sample Screenshots below:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_ex9GjJ9fvbk/TNRSVi6b4wI/AAAAAAAAAPA/ryruge55o0c/s1600/2.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img <="" border="0" height="97" img="" src="http://4.bp.blogspot.com/_ex9GjJ9fvbk/TNRSVi6b4wI/AAAAAAAAAPA/ryruge55o0c/s320/2.JPG" width="320" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_ex9GjJ9fvbk/TNRSddqSSDI/AAAAAAAAAPI/PgxkEc36aQA/s1600/3.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img <="" border="0" height="109" img="" src="http://2.bp.blogspot.com/_ex9GjJ9fvbk/TNRSddqSSDI/AAAAAAAAAPI/PgxkEc36aQA/s320/3.JPG" width="320" /></a></div>