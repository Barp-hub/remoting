<p>2台Cisco ASA 5520 防火墙做FailOver双机热备，因特殊原因，需要重启，经测试，通过切换主备分别重启，没有任何丢包。记录下步骤：</p>
<p>先介绍下环境，一共有2台防火墙，重启前的状态：</p>
<ol>
<li>172.24.1.250 主</li>
<li>172.24.1.251  备</li>
</ol>
<p><span id="more-874"></span></p>
<p><a href="http://www.huilog.com/wp-content/uploads/2017/05/微信图片_20170517214933.png"><img class="alignnone wp-image-875 size-full" src="http://www.huilog.com/wp-content/uploads/2017/05/微信图片_20170517214933.png" alt="" width="636" height="651" srcset="http://www.huilog.com/wp-content/uploads/2017/05/微信图片_20170517214933.png 636w, http://www.huilog.com/wp-content/uploads/2017/05/微信图片_20170517214933-293x300.png 293w" sizes="(max-width: 636px) 100vw, 636px" /></a></p>
<p>重启步骤如下：</p>
<ol>
<li>先在主机（172.24.1.250）重启备机 命令：failover reload-standby</li>
</ol>
<p><a href="http://www.huilog.com/wp-content/uploads/2017/05/微信图片_20170517215238.png"><img class="alignnone wp-image-876 size-full" src="http://www.huilog.com/wp-content/uploads/2017/05/微信图片_20170517215238.png" alt="" width="636" height="151" srcset="http://www.huilog.com/wp-content/uploads/2017/05/微信图片_20170517215238.png 636w, http://www.huilog.com/wp-content/uploads/2017/05/微信图片_20170517215238-300x71.png 300w" sizes="(max-width: 636px) 100vw, 636px" /></a></p>
<p>2. 等备机（172.24.1.251）重启好后，再用show failover看看状态，没问题再执行下一步：</p>
<p><a href="http://www.huilog.com/wp-content/uploads/2017/05/微信图片_20170517215613.png"><img class="alignnone wp-image-877 size-full" src="http://www.huilog.com/wp-content/uploads/2017/05/微信图片_20170517215613.png" alt="" width="592" height="699" srcset="http://www.huilog.com/wp-content/uploads/2017/05/微信图片_20170517215613.png 592w, http://www.huilog.com/wp-content/uploads/2017/05/微信图片_20170517215613-254x300.png 254w" sizes="(max-width: 592px) 100vw, 592px" /></a></p>
<p>3. 主备切换，切换后，主备机器上的IP地址对调</p>
<p>分别连上主备防火墙，用命令show interface ip brief确认主备机器上的IP地址，没问题的话，在备机（172.24.1.251）执行命令：failover active，在执行这个命令前可分别ping 主备机器的IP，查看丢包情况，我的测试是没有丢包。</p>
<p>切换后，主备机器上的IP已经对调，这时候主机IP为172.24.1.251,备机为172.24.1.250，备机是active状态</p>
<p><a href="http://www.huilog.com/wp-content/uploads/2017/05/微信图片_20170517220314.png"><img class="alignnone wp-image-878 size-full" src="http://www.huilog.com/wp-content/uploads/2017/05/微信图片_20170517220314.png" alt="" width="571" height="512" srcset="http://www.huilog.com/wp-content/uploads/2017/05/微信图片_20170517220314.png 571w, http://www.huilog.com/wp-content/uploads/2017/05/微信图片_20170517220314-300x269.png 300w" sizes="(max-width: 571px) 100vw, 571px" /></a></p>
<p>4. 在备机（IP已是172.24.1.250）上执行failover reload-standby，等待主机（IP已是172.24.1.251）重启完成</p>
<p>&#160;</p>
<p>5. 等待主机重启完成后，在主机执行：failover active，完成主备切换，回到重启前的状态，IP地址又对调回来，主机IP为172.24.1.250,备机为172.24.1.251，主机是active状态。</p>
