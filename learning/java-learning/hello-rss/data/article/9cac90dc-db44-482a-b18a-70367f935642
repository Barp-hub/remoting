<div dir="ltr" style="text-align: left;" trbidi="on">After learning about <a href="http://www.adftips.com/2011/01/adf-model-different-date-effective.html">different Date-Effective update modes available in ADF 11g and their behavior</a>, now let us move to date-effective delete modes. Understanding and using different DE delete modes also little tricky. Please go through below explanation of different DE delete modes along with examples.<br /><br />All the date-effective delete modes are defined as constants in&nbsp;<a href="http://download.oracle.com/docs/cd/E15523_01/apirefs.1111/e10653/oracle/jbo/Row.html">oracle.job.Row</a>&nbsp;class as any kind of effective dated operation is performed on a row itself. Before going into details, let us take an example to explain the concepts. For example, we'll take the same example of 'Job' date-effective object and explain different date-effective delete modes available. <a href="http://adftips.googlecode.com/files/DateEffective_Delete_Modes.zip">Sample application having the required code to perform the DE delete operations can be downloaded from here</a>.<br /><br /><b>The following DE delete modes available in Jdeveloper 11g:</b><br /><b>1.EFFDT_DELETE_NEXT_CHANGE_MODE:</b> When an effective dated row is deleted in "delete next change" mode, the end date of the row is set to the end date of adjoining row and the adjoining row is deleted.<br />For example, if the Job with JobId&nbsp;<span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">100000020529001</span>&nbsp;has the following date-effective rows,<br /><a href="http://2.bp.blogspot.com/_ex9GjJ9fvbk/TSCunVw5MxI/AAAAAAAAAXA/49iVagf2n9c/s1600/1.JPG" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="108" src="http://2.bp.blogspot.com/_ex9GjJ9fvbk/TSCunVw5MxI/AAAAAAAAAXA/49iVagf2n9c/s640/1.JPG" style="cursor: move;" width="640" /></a><br />And, if the current row is [<span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">100000020529001,01-Jan-2011,31-Dec-2012</span>] (or if the current effective date falls in the range of&nbsp;<span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">01-Jan-1900 and 31-Dec-2012</span>) and if we want to delete the next date-effective row i.e., [<span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">100000020529001,01-Jan-2013,31-Dec-4712</span>], we'll use&nbsp;EFFDT_DELETE_NEXT_CHANGE_MODE.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_ex9GjJ9fvbk/TSCzF5Iak7I/AAAAAAAAAXI/0T-Sr1wGFhs/s1600/3.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="238" src="http://2.bp.blogspot.com/_ex9GjJ9fvbk/TSCzF5Iak7I/AAAAAAAAAXI/0T-Sr1wGFhs/s320/3.JPG" width="320" /></a></div>After deleting the row in&nbsp;EFFDT_DELETE_NEXT_CHANGE_MODE, the resultant rows will be:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_ex9GjJ9fvbk/TSCuodfx_LI/AAAAAAAAAXE/019WEsDVUNQ/s1600/2.JPG" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="88" src="http://1.bp.blogspot.com/_ex9GjJ9fvbk/TSCuodfx_LI/AAAAAAAAAXE/019WEsDVUNQ/s640/2.JPG" width="640" /></a></div><br /><b>2. EFFDT_DELETE_THIS_CHANGE_MODE:</b> When an effective dated row is deleted in "delete this change" mode, the current row is removed.<br />For example, let us continue with the same above 3 rows and if we want to delete the Job Row [<span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">100000020529001,01-Jan-1950,31-Dec-2010</span>], we need to make this row as current row (i.e., the effective date will be between&nbsp;<span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">1-Jan-1950 and 31-Dec-2010) and delete the row in&nbsp;</span>EFFDT_DELETE_THIS_CHANGE_MODE<b>.</b><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_ex9GjJ9fvbk/TSC1RNC1RAI/AAAAAAAAAXM/lKRxcHAOLSQ/s1600/4.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="240" src="http://4.bp.blogspot.com/_ex9GjJ9fvbk/TSC1RNC1RAI/AAAAAAAAAXM/lKRxcHAOLSQ/s320/4.JPG" width="320" /></a></div>&nbsp;After deleting the current row in&nbsp;EFFDT_DELETE_THIS_CHANGE_MODE, the resultant rows will be:<br /><a href="http://3.bp.blogspot.com/_ex9GjJ9fvbk/TSC1R-wTqAI/AAAAAAAAAXQ/yV0SNv2HtJ4/s1600/5.JPG" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="66" src="http://3.bp.blogspot.com/_ex9GjJ9fvbk/TSC1R-wTqAI/AAAAAAAAAXQ/yV0SNv2HtJ4/s640/5.JPG" width="640" /></a><br /><br /><b>3.EFFDT_DELETE_MODE:</b> When an effective dated row is deleted in "delete" mode, the end date of the row is set to the row's effective date and all the future rows for the same key values are deleted.<br />For example, let us assume that we have the following 4 date effective rows for the job with JobId&nbsp;<span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">100000020529001</span><br /><a href="http://3.bp.blogspot.com/_ex9GjJ9fvbk/TSC4KE-mg_I/AAAAAAAAAXU/AKz9GLsIGtQ/s1600/6.JPG" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="110" src="http://3.bp.blogspot.com/_ex9GjJ9fvbk/TSC4KE-mg_I/AAAAAAAAAXU/AKz9GLsIGtQ/s640/6.JPG" style="cursor: move;" width="640" /></a><br /><span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;"></span>And, if we want to end date the 2nd row i.e., [<span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">100000020529001,01-Jan-1950,31-Dec-1974</span>] at 01-Jan-1960 and want to delete all the future rows, we'll pass the effective date&nbsp;01-Jan-1960&nbsp;and use the mode&nbsp;EFFDT_DELETE_MODE.<br /><a href="http://3.bp.blogspot.com/_ex9GjJ9fvbk/TSC4K5BHJhI/AAAAAAAAAXY/FnbNY7bsRGw/s1600/7.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="239" src="http://3.bp.blogspot.com/_ex9GjJ9fvbk/TSC4K5BHJhI/AAAAAAAAAXY/FnbNY7bsRGw/s320/7.JPG" width="320" /></a><br />After deleting the rows in&nbsp;<b>EFFDT_DELETE_MODE mode, the resultant rows will be:</b><br /><a href="http://3.bp.blogspot.com/_ex9GjJ9fvbk/TSC4LxFEE2I/AAAAAAAAAXc/JkjB5yAJmSk/s1600/8.JPG" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="64" src="http://3.bp.blogspot.com/_ex9GjJ9fvbk/TSC4LxFEE2I/AAAAAAAAAXc/JkjB5yAJmSk/s640/8.JPG" width="640" /></a><b><span class="Apple-style-span" style="font-weight: normal;"></span></b><br /><b>4.EFFDT_DELETE_FUTURE_CHANGE_MODE:</b> When an effective dated row is deleted in "delete future change" mode, the end date of the row is set to the end of time and all the future rows for the same key values are deleted.<br />For example, let us assume that we have the following 4 date effective rows for the job with JobId&nbsp;<span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">100000020529001</span><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_ex9GjJ9fvbk/TSC88sosTLI/AAAAAAAAAXg/VNv8p0i0uOE/s1600/9.JPG" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="96" src="http://1.bp.blogspot.com/_ex9GjJ9fvbk/TSC88sosTLI/AAAAAAAAAXg/VNv8p0i0uOE/s640/9.JPG" width="640" /></a></div>And, if we want to delete all future date-effective rows starting from 01-Jan-1975, then, we need to make the row&nbsp;[<span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">100000020529001,</span><span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">01-Jan-1950</span><span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">,31-Dec-1974</span>] as current row (or make effective date between&nbsp;<span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">01-Jan-1950 and&nbsp;</span><span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">31-Dec-1974</span>) and delete the rows in EFFDT_DELETE_FUTURE_CHANGE_MODE. This will&nbsp;delete all remaining future rows and end date the current row i.e.,&nbsp;[<span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">100000020529001,</span><span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">01-Jan-1950</span><span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">,31-Dec-1974</span>]&nbsp;till EOT(31-12-4712).<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_ex9GjJ9fvbk/TSDAYOfK_WI/AAAAAAAAAXk/HwDp5cvxEkA/s1600/10.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="240" src="http://1.bp.blogspot.com/_ex9GjJ9fvbk/TSDAYOfK_WI/AAAAAAAAAXk/HwDp5cvxEkA/s320/10.JPG" width="320" /></a></div>&nbsp;The resultant rows after deleting the rows in&nbsp;EFFDT_DELETE_FUTURE_CHANGE_MODE will be:<br /><a href="http://4.bp.blogspot.com/_ex9GjJ9fvbk/TSDAY8sqTaI/AAAAAAAAAXo/2b9qvC1S_kg/s1600/11.JPG" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="62" src="http://4.bp.blogspot.com/_ex9GjJ9fvbk/TSDAY8sqTaI/AAAAAAAAAXo/2b9qvC1S_kg/s640/11.JPG" style="cursor: move;" width="640" /></a><br /><br /><b>5.EFFDT_DELETE_ZAP_MODE:</b> When an effective dated row is deleted in "zap" mode, all the effective dated rows with the same key values are deleted.<br />For example, let us assume that we have the following 4 date effective rows for the job with JobId&nbsp;<span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">100000020529001</span><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_ex9GjJ9fvbk/TSDCEcD7mkI/AAAAAAAAAXs/f58LUUEf7Gs/s1600/12.JPG" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="98" src="http://4.bp.blogspot.com/_ex9GjJ9fvbk/TSDCEcD7mkI/AAAAAAAAAXs/f58LUUEf7Gs/s640/12.JPG" width="640" /></a></div><span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">And, if we want to delete all date-effective records of this job, we need to use&nbsp;</span>EFFDT_DELETE_ZAP_MODE. Effective Date won't make any difference in this mode as it'll delete all existing date-effective records.<br /><span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;"><span class="Apple-style-span" style="color: black; font-family: 'Times New Roman'; font-size: small; line-height: normal;"><a href="http://3.bp.blogspot.com/_ex9GjJ9fvbk/TSDCFSA4-uI/AAAAAAAAAXw/R1j58EaA7Po/s1600/13.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="239" src="http://3.bp.blogspot.com/_ex9GjJ9fvbk/TSDCFSA4-uI/AAAAAAAAAXw/R1j58EaA7Po/s320/13.JPG" width="320" /></a></span></span><br /><span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;">After deleting the rows in Zap mode, &nbsp;all the date-effective rows got deleted:</span><br /><span class="Apple-style-span" style="color: #333333; font-family: Georgia,serif; font-size: 13px; line-height: 20px;"><span class="Apple-style-span" style="color: black; font-family: 'Times New Roman'; font-size: small; line-height: normal;"><a href="http://4.bp.blogspot.com/_ex9GjJ9fvbk/TSDCGdWdjPI/AAAAAAAAAX0/x7UqTk1JsJY/s1600/14.JPG" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="66" src="http://4.bp.blogspot.com/_ex9GjJ9fvbk/TSDCGdWdjPI/AAAAAAAAAX0/x7UqTk1JsJY/s640/14.JPG" width="640" /></a></span></span><br /><br />Here is the method that I wrote to accomplish all of these DE delete operations with different DE delete modes (download the sample application for to find the method references used in the below code).<br /><div id="iframeDivbc564467-18a9-4aae-87b7-309432193729" style="display: none; margin: 0px;"><iframe frameborder="0" id="iframebc564467-18a9-4aae-87b7-309432193729" src="http://www.blogtrog.com/code.aspx?id=bc564467-18a9-4aae-87b7-309432193729" style="border: 1px solid rgb(224, 224, 224); height: 400px; margin: 0px; width: 400px;"></iframe></div><div id="noIframeDivbc564467-18a9-4aae-87b7-309432193729" style="display: block; margin: 0px;"><pre><div><span style="color: black;">  </span><span style="color: blue;">public</span><span style="color: black;"> </span><span style="color: blue;">void</span><span style="color: black;"> deleteJobRow(Long jobId, Date effectiveDate) {<br />      </span><span style="color: blue;">if</span><span style="color: black;"> (effectiveDate </span><span style="color: black;">==</span><span style="color: black;"> </span><span style="color: blue;">null</span><span style="color: black;">) {<br />          </span><span style="color: blue;">throw</span><span style="color: black;"> </span><span style="color: blue;">new</span><span style="color: black;"> JboException(</span><span style="color: black;">"</span><span style="color: black;">Effective Date cannot be null</span><span style="color: black;">"</span><span style="color: black;">);<br />      }<br />      </span><span style="color: blue;">if</span><span style="color: black;"> (effectiveDate.compareTo(DateUtils.convertTosqlDate(MIN_START_DATE)) </span><span style="color: black;">&lt;=</span><span style="color: black;"><br />          </span><span style="color: black;">0</span><span style="color: black;"> </span><span style="color: black;">||</span><span style="color: black;"><br />          effectiveDate.compareTo(DateUtils.convertTosqlDate(MAX_END_DATE)) </span><span style="color: black;">&gt;=</span><span style="color: black;"><br />          </span><span style="color: black;">0</span><span style="color: black;">) {<br />          </span><span style="color: blue;">throw</span><span style="color: black;"> </span><span style="color: blue;">new</span><span style="color: black;"> JboException(</span><span style="color: black;">"</span><span style="color: black;">EffectiveDate cannot be before SOT and cannot be later than EOT</span><span style="color: black;">"</span><span style="color: black;">);<br />      }<br />      </span><span style="color: green;">//</span><span style="color: green;">getting the Job row effective as of the given effectiveDate</span><span style="color: green;"><br /></span><span style="color: black;">      Row jobRow </span><span style="color: black;">=</span><span style="color: black;"> getRowAsOfDate(jobId, effectiveDate);<br />      </span><span style="color: blue;">if</span><span style="color: black;"> (jobRow </span><span style="color: black;">!=</span><span style="color: black;"> </span><span style="color: blue;">null</span><span style="color: black;">) {<br />          </span><span style="color: blue;">try</span><span style="color: black;"> {<br />              </span><span style="color: green;">//</span><span style="color: green;">Set the required date-effective delete mode. Here I'm setting it to EFFDT_DELETE_THIS_CHANGE_MODE</span><span style="color: green;"><br /></span><span style="color: black;">              jobRow.setEffectiveDateMode(Row.EFFDT_DELETE_THIS_CHANGE_MODE );<br />              jobRow.remove();<br />          } </span><span style="color: blue;">catch</span><span style="color: black;"> (Exception e) {<br />              e.printStackTrace();<br />          }<br />          </span><span style="color: blue;">this</span><span style="color: black;">.getDBTransaction().commit();<br />      }<br />  }</span></div></pre></div><script language="javascript" src="http://www.blogtrog.com/scripts/bt_code.js" type="text/javascript"></script><script language="javascript" type="text/javascript">bt_code_init('bc564467-18a9-4aae-87b7-309432193729'); </script><br />In the above method, we're actually getting the Job row effective as of the passed effective date(this will make that effective-dated row as current row) and then performing date-effective delete operations basing on that row.<br /><br /><b>Instructions to run the <a href="http://adftips.googlecode.com/files/DateEffective_Delete_Modes.zip">sample application</a>:</b><br />1. Create the required tables for illustrating date-effective operations executing the&nbsp;<a href="http://adftips.googlecode.com/files/de_sql.sql">sql script downloading from here</a>.<br /><div style="margin: 0px;">2. Unzip the sample application and, run the DemoAM. Input JobId, effective date and click 'Execute'.</div><div style="margin: 0px;">3. Change the date-effective delete mode in method 'deleteJobRow' each time you want to change the delete mode(right now it's hard coded to&nbsp;EFFDT_DELETE_THIS_CHANGE_MODE), rebuild and continue. You can find the screen shots above how to provide input in AM Tester.</div><div style="margin: 0px;">4. Query the DB to find the resultant rows after the delete operation.</div><div id="iframeDivc55a9fb0-6439-440c-89ae-f7b636c1959d" style="display: none; margin: 0px;"><iframe frameborder="0" id="iframec55a9fb0-6439-440c-89ae-f7b636c1959d" src="http://www.blogtrog.com/code.aspx?id=c55a9fb0-6439-440c-89ae-f7b636c1959d" style="border: 1px solid rgb(224, 224, 224); height: 200px; margin: 0px; width: 400px;"></iframe></div><div id="noIframeDivc55a9fb0-6439-440c-89ae-f7b636c1959d" style="display: block; margin: 0px;"><pre><div><span style="color: blue;">SELECT</span><span style="color: black;"> Job_ID,<br />  TO_CHAR(effective_start_date,</span><span style="color: red;">'</span><span style="color: red;">dd-Mon-yyyy</span><span style="color: red;">'</span><span style="color: black;">) </span><span style="color: blue;">AS</span><span style="color: black;"> ESD,<br />  TO_CHAR(effective_end_date,</span><span style="color: red;">'</span><span style="color: red;">dd-Mon-yyyy</span><span style="color: red;">'</span><span style="color: black;">)   </span><span style="color: blue;">AS</span><span style="color: black;"> EED,<br />  JOB_NAME,<br />  MIN_SAL,<br />  MAX_SAL,<br />  STATUS,<br />  JOB_LEVEL,<br />  MED_CHECK_REQ </span><span style="color: blue;">AS</span><span style="color: black;"> MED_CHECK<br /></span><span style="color: blue;">FROM</span><span style="color: black;"> de_jobs<br /></span><span style="color: blue;">WHERE</span><span style="color: black;"> job_id</span><span style="color: grey;">=</span><span style="color: maroon; font-weight: bold;">100000020529001</span><span style="color: black;"><br /></span><span style="color: blue;">ORDER</span><span style="color: black;"> </span><span style="color: blue;">BY</span><span style="color: black;"> effective_start_date;</span></div></pre></div><script language="javascript" src="http://www.blogtrog.com/scripts/bt_code.js" type="text/javascript"></script><script language="javascript" type="text/javascript">bt_code_init('c55a9fb0-6439-440c-89ae-f7b636c1959d'); </script><br />Enjoy!!!</div>